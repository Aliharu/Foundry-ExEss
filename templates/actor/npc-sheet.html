<form class="{{cssClass}} flexcol character-sheet-background" autocomplete="off">
    <header class="sheet-header">
        <div class="profile-img-wrapper">
            <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}" height="100"
                width="100" />
            <div class="flex-center">
                <label class="resource-label">{{localize "ExEss.Essence"}}</label>
                <input type="number" name="data.essence.value" value="{{data.data.essence.value}}"
                    data-dtype="Number" />
            </div>
            <div class="flex-center">
                <div class="resource-label">{{localize "ExEss.Battlegroup"}}</div>
                <input data-dtype="Boolean" name="data.battlegroup" type="checkbox" {{checked data.data.battlegroup}}>
            </div>
        </div>
        <div class="header-fields">
            <div>
                <h1 class="charname"><input name="name" type="text" value="{{actor.name}}"
                        placeholder="{{localize 'ExEss.NameTitle'}}" /></h1>
            </div>
            <div class="grid grid-3col flexrow">
                <h1 class="charname"> <select name="data.creaturetype" data-type="String">
                        {{#select data.data.creaturetype}}
                        <option value="animal">{{localize "ExEss.Animal"}}</option>
                        <option value="demon">{{localize "ExEss.Demon"}}</option>
                        <option value="exalt">{{localize "ExEss.Exalt"}}</option>
                        <option value="fae">{{localize "ExEss.Fae"}}</option>
                        <option value="mortal">{{localize "ExEss.Mortal"}}</option>
                        <option value="undead">{{localize "ExEss.Undead"}}</option>
                        <option value="other">{{localize "ExEss.Other"}}</option>
                        {{/select}}
                    </select></h1>
                {{#ifEquals data.data.creaturetype 'demon'}}
                <h1 class="charname"> <select name="data.details.exalt" data-type="String">
                        {{#select data.data.details.exalt}}
                        <option value="first">{{localize "ExEss.First"}} {{localize "ExEss.Circle"}}</option>
                        <option value="second">{{localize "ExEss.Second"}} {{localize "ExEss.Circle"}}</option>
                        <option value="third">{{localize "ExEss.Third"}} {{localize "ExEss.Circle"}}</option>
                        {{/select}}
                    </select></h1>
                {{/ifEquals}}

                {{#ifEquals data.data.creaturetype 'exalt'}}
                <h1 class="charname"> <select name="data.details.exalt" data-type="String">
                        {{#select data.data.details.exalt}}
                        <option value="abyssal">{{localize "ExEss.Abyssal"}}</option>
                        <option value="alchemical">{{localize "ExEss.Alchemical"}}</option>
                        <option value="dragonblooded">{{localize "ExEss.Dragonblooded"}}</option>
                        <option value="exigent">{{localize "ExEss.Exigent"}}</option>
                        <option value="getimian">{{localize "ExEss.Getimian"}}</option>
                        <option value="infernal">{{localize "ExEss.Infernal"}}</option>
                        <option value="liminal">{{localize "ExEss.Liminal"}}</option>
                        <option value="lunar">{{localize "ExEss.Lunar"}}</option>
                        <option value="sidereal">{{localize "ExEss.Sidereal"}}</option>
                        <option value="solar">{{localize "ExEss.Solar"}}</option>
                        <option value="other">{{localize "ExEss.Other"}}</option>
                        {{/select}}
                    </select></h1>
                <h1 class="charname"><input name="data.details.caste" type="text" value="{{data.data.details.caste}}"
                        placeholder="{{localize 'ExEss.CasteAspect'}}" /></h1>
                {{/ifEquals}}

                {{#ifEquals data.data.creaturetype 'fae'}}
                <h1 class="charname"> <select name="data.details.exalt" data-type="String">
                        {{#select data.data.details.exalt}}
                        <option value="creature">{{localize "ExEss.Creature"}}</option>
                        <option value="raksha">{{localize "ExEss.Raksha"}}</option>
                        {{/select}}
                    </select></h1>
                {{/ifEquals}}
            </div>
            {{!-- The grid classes are defined in scss/global/_grid.scss. To use,
            use both the "grid" and "grid-Ncol" class where "N" can be any number
            from 1 to 12 and will create that number of columns. --}}
            <div class="resources grid grid-3col">
                <div class="resource-content flexrow flex-center flex-between">
                    <div>
                        <label class="resource-label">{{localize "ExEss.Motes"}}</label>
                        <div class="resource-content flexrow flex-center flex-between">
                            <input type="number" name="data.motes.value" value="{{data.data.motes.value}}"
                                data-dtype="Number" />
                            /
                            <div>{{data.data.motes.total}}</div>
                        </div>
                    </div>
                    <div>
                        <label class="resource-label">{{localize "ExEss.Commited"}}</label>
                        <input type="number" name="data.commited.value" value="{{data.data.commited.value}}"
                            data-dtype="Number" />
                    </div>
                </div>
                <div class="resource-content flexrow flex-center flex-between">
                    <div>
                        <label class="resource-label">{{localize "ExEss.Anima"}}</label>
                        <input type="number" name="data.anima.value" value="{{data.data.anima.value}}"
                            data-dtype="Number" />
                    </div>
                    <div>
                        <div class="resource-label" style="margin-top: 18px;">{{data.data.anima.level}}</div>
                    </div>
                </div>
                <div class="resource-content flexrow flex-center flex-between">
                    {{#ifEquals data.data.details.exalt 'getimian'}}
                    <div>
                        <label class="resource-label">{{localize "ExEss.Flowing"}}</label>
                        <div class="resource-content flexrow flex-center flex-between">
                            <input type="number" name="data.flowing.value" value="{{data.data.flowing.value}}"
                                data-dtype="Number" />
                            /
                            <input type="number" name="data.flowing.total" value="{{data.data.flowing.total}}"
                                data-dtype="Number" />
                        </div>
                    </div>
                    <div>
                        <label class="resource-label">{{localize "ExEss.Still"}}</label>
                        <div class="resource-content flexrow flex-center flex-between">
                            <input type="number" name="data.still.value" value="{{data.data.still.value}}"
                                data-dtype="Number" />
                            /
                            <input type="number" name="data.still.total" value="{{data.data.still.total}}"
                                data-dtype="Number" />
                        </div>
                    </div>
                    {{/ifEquals}}
                    {{#ifEquals data.data.details.exalt 'lunar'}}
                    <div>
                        <label class="resource-label">{{localize "ExEss.SacredHunt"}}</label>
                        <input type="text" name="data.details.hunt" value="{{data.data.details.hunt}}" />
                    </div>
                    {{/ifEquals}}

                </div>
            </div>
            <div class="resources grid grid-3col">
                {{!-- "flex-group-center" is also defined in the _grid.scss file
                and it will add a small amount of padding, a border, and will
                center all of its child elements content and text. --}}
                <div class="resource flex-group-center">
                    <div class="flexrow">
                        <label for="data.health" class="resource-label">{{localize "ExEss.Health"}}</label>
                    </div>
                    <div class="resource-content flexrow flex-center flex-between">
                        <div class="resource-counter" data-states="/:lethal,x:aggravated"
                            data-max="{{data.data.health.levels}}" data-lethal="{{data.data.health.lethal}}"
                            data-aggravated="{{data.data.health.aggravated}}" data-name="data.health">
                            {{#numLoop data.data.health.levels}}
                            <span class="resource-counter-step" data-index="{{this}}" data-state=""></span>
                            {{/numLoop}}
                        </div>
                    </div>
                </div>
                <div class="flex-center">
                    <label class="resource-label">{{localize "ExEss.HealthLevels"}}</label>
                    <div class="d-flex flex-center resources">
                        <input type="number" name="data.health.levels" value="{{data.data.health.levels}}"
                            data-dtype="Number" />
                    </div>
                </div>
                <div>
                    <div class="flex-center">
                        <div class="resource-label">{{localize "ExEss.CurrentWoundPenalty"}}</div>
                        <div class="resource-calculated-value">-{{data.data.health.penalty}}</div>
                    </div>
                </div>
            </div>
            <div class="resources grid">
                <button id="rollDice" class="roll-button">{{localize "ExEss.RollDice"}}</button>
                <button id="rollAbility" class="roll-button">{{localize "ExEss.RollAbility"}}</button>
            </div>
        </div>
    </header>

    <nav class="sheet-tabs tabs" data-group="primary">
        <a class="item" data-tab="stats">{{localize "ExEss.Stats"}}</a>
        <a class="item" data-tab="qualities">{{localize "ExEss.Qualities"}}</a>
        <a class="item" data-tab="charms">{{localize "ExEss.Charms"}}/{{localize "ExEss.Spells"}}</a>
        <a class="item" data-tab="intimacies">{{localize "ExEss.Intimacies"}}</a>
        <a class="item" data-tab="description">{{localize "ExEss.Description"}}</a>
    </nav>

    <section class="sheet-body">
        <div class="tab flex-center" data-group="primary" data-tab="stats">
            <div class="flex-group-center">
                <div class="flex-group-left pool">
                    <label class="resource-label">
                        {{localize "ExEss.Primary"}} {{localize "ExEss.Pool"}}
                    </label>
                    <div class="d-flex">
                        <input class="pool-value-input" type="number" name="data.pools.primary.value"
                            value="{{data.data.pools.primary.value}}" data-dtype="Number" />
                        <input type="text" name="data.pools.primary.actions" value="{{data.data.pools.primary.actions}}"
                            placeholder="Input what actions this pool covers" />
                    </div>
                </div>
                <div class="flex-group-left pool">
                    <label class="resource-label">
                        {{localize "ExEss.Secondary"}} {{localize "ExEss.Pool"}}
                    </label>
                    <div class="d-flex">
                        <input class="pool-value-input" type="number" name="data.pools.secondary.value"
                            value="{{data.data.pools.secondary.value}}" data-dtype="Number" />
                        <input type="text" name="data.pools.secondary.actions"
                            value="{{data.data.pools.secondary.actions}}"
                            placeholder="Input what actions this pool covers" />
                    </div>
                </div>
                <div class="flex-group-left pool">
                    <label class="resource-label">
                        {{localize "ExEss.Tertiary"}} {{localize "ExEss.Pool"}}
                    </label>
                    <div class="d-flex">
                        <input class="pool-value-input" type="number" name="data.pools.tertiary.value"
                            value="{{data.data.pools.tertiary.value}}" data-dtype="Number" />
                        <input type="text" name="data.pools.tertiary.actions"
                            value="{{data.data.pools.tertiary.actions}}"
                            placeholder="Input what actions this pool covers" />
                    </div>
                </div>
            </div>
            <div class="grid grid-2col flex-group-center">
                <div class="resource-content flexrow flex-center flex-between">
                    <div>
                        <label class="resource-label">{{localize "ExEss.Power"}}</label>
                        <input type="number" name="data.power.value" value="{{data.data.power.value}}"
                            data-dtype="Number" />
                    </div>
                    <div>
                        <label class="resource-label">{{localize "ExEss.Will"}}</label>
                        <input type="number" name="data.will.value" value="{{data.data.will.value}}"
                            data-dtype="Number" />
                    </div>
                    <div>
                        <label class="resource-label">{{localize "ExEss.Stunt"}} {{localize "ExEss.Dice"}}</label>
                        <input type="number" name="data.stunt.value" value="{{data.data.stunt.value}}"
                            data-dtype="Number" />
                    </div>
                </div>
                <div class="resource-content flexrow flex-center flex-between">
                    <div>
                        <label class="resource-label">{{localize "ExEss.BuildPower"}}</label>
                        <button id="buildPower" class="roll-button">{{localize "ExEss.Roll"}}</button>
                    </div>
                    <div>
                        <label class="resource-label">{{localize "ExEss.FocusWill"}}</label>
                        <button id="focusWill" class="roll-button">{{localize "ExEss.Roll"}}</button>
                    </div>
                </div>
            </div>
            <div class="grid grid-3col flex-group-center">
                <div class="resource-content flexrow flex-center flex-between">
                    <div>
                        <label class="resource-label">{{localize "ExEss.Defence"}}</label>
                        <input type="number" name="data.defence.value" value="{{data.data.defence.value}}"
                            data-dtype="Number" />
                    </div>
                    <div>
                        <label class="resource-label">{{localize "ExEss.Resolve"}}</label>
                        <input type="number" name="data.resolve.value" value="{{data.data.resolve.value}}"
                            data-dtype="Number" />
                    </div>
                </div>
                <div class="resource-content flexrow flex-center flex-between">
                    <div>
                        <label class="resource-label">{{localize "ExEss.Soak"}}</label>
                        <input type="number" name="data.soak.value" value="{{data.data.soak.value}}"
                            data-dtype="Number" />
                    </div>
                    <div>
                        <label class="resource-label">{{localize "ExEss.Hardness"}}</label>
                        <input type="number" name="data.hardness.value" value="{{data.data.hardness.value}}"
                            data-dtype="Number" />
                    </div>
                </div>
                {{#if data.data.battlegroup}}
                <div class="resource-content flexrow flex-center flex-between">
                    <div>
                        <label class="resource-label">{{localize "ExEss.Size"}}</label>
                        <input type="number" name="data.size.value" value="{{data.data.size.value}}"
                            data-dtype="Number" />
                    </div>
                    <div>
                        <label class="resource-label">{{localize "ExEss.Drill"}}</label>
                        <input type="number" name="data.drill.value" value="{{data.data.drill.value}}"
                            data-dtype="Number" />
                    </div>
                </div>
                {{/if}}
            </div>
            <div>
                <textarea type="text" name="data.qualities" rows="6">{{data.data.qualities}}</textarea>
            </div>
            <div>
                <label class="resource-label">{{localize "ExEss.Weapons"}}</label>
                <ol class="items-list">
                    <li class="item flexrow item-header">
                        <div class="item-image"></div>
                        <div class="item-name">Name</div>
                        <div class="item-name">{{localize "ExEss.Accuracy"}}</div>
                        <div class="item-name">{{localize "ExEss.Damage"}}</div>
                        <div class="item-name">{{localize "ExEss.Defence"}}</div>
                        <div class="item-name">Ov</div>
                        <div></div>
                        <div></div>
                        <div class="item-controls">
                            <a class="item-control item-create" title="Create weapon" data-type="weapon"><i
                                    class="fas fa-plus"></i>
                                Add</a>
                        </div>
                    </li>
                    {{#each actor.weapons as |item id|}}
                    <li class="item item-large flexrow" data-item-id="{{item._id}}">
                        <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24" />
                        </div>
                        <h4 class="item-name">{{item.name}}</h4>
                        <div class="resource-value-static">
                            {{item.data.accuracy}}
                        </div>
                        <div class="resource-value-static">
                            {{item.data.damage}}
                        </div>
                        <div class="resource-value-static">
                            {{item.data.defence}}
                        </div>
                        <div class="resource-value-static">
                            {{item.data.overwhelming}}
                        </div>
                        <div>
                            <button id="rollWithering" class="roll-button" data-accuracy="{{item.data.accuracy}}"
                                data-damage="{{item.data.damage}}"
                                data-overwhelming="{{item.data.overwhelming}}">{{localize
                                "ExEss.Withering"}}</button>
                        </div>
                        <div>
                            <button id="rollDecisive" class="roll-button" data-accuracy="{{item.data.accuracy}}"
                                data-damage="{{item.data.damage}}"
                                data-overwhelming="{{item.data.overwhelming}}">{{localize
                                "ExEss.Decisive"}}</button>
                        </div>
                        <div class="item-controls">
                            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                        </div>
                    </li>
                    {{/each}}
                </ol>
            </div>
            <div>
                <label class="resource-label">{{localize "ExEss.Armor"}}</label>
                <ol class="items-list">
                    <li class="item flexrow item-header">
                        <div class="item-image"></div>
                        <div class="item-name">Name</div>
                        <div class="item-name">{{localize "ExEss.Soak"}}</div>
                        <div class="item-name">{{localize "ExEss.Penalty"}}</div>
                        <div class="item-name">{{localize "ExEss.Hardness"}}</div>
                        <div class="item-controls">
                            <a class="item-control item-create" title="Create armor" data-type="armor"><i
                                    class="fas fa-plus"></i>
                                Add</a>
                        </div>
                    </li>
                    {{#each actor.armor as |item id|}}
                    <li class="item item-large flexrow" data-item-id="{{item._id}}">
                        <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24" />
                        </div>
                        <h4 class="item-name">{{item.name}}</h4>
                        <div class="resource-value-static">
                            {{item.data.soak}}
                        </div>
                        <div class="resource-value-static">
                            {{item.data.penalty}}
                        </div>
                        <div class="resource-value-static">
                            {{item.data.hardness}}
                        </div>
                        <div class="item-controls">
                            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                        </div>
                    </li>
                    {{/each}}
                </ol>
            </div>
        </div>
        {{!-- Qualities Tab --}}
        <div class="tab items" data-group="primary" data-tab="qualities">
            <ol class="items-list">
                <li class="item flexrow item-header">
                    <div class="item-image"></div>
                    <div class="item-name"></div>
                    <div class="qualities-controls d-flex">
                        <a class="item-control margin-right item-create" title="Create quality" data-type="quality"><i
                                class="fas fa-plus"></i> Add quality</a>
                    </div>
                </li>
                <li>
                    <div class="resource-label flex-center list-section-header">
                        {{localize "ExEss.Qualities"}}
                    </div>
                </li>
                <li class="item flexrow item-header">
                    <div class="item-image"></div>
                    <div class="item-name">Name</div>
                </li>
                {{#each actor.qualities as |item id|}}
                <li class="item flexrow" data-item-id="{{item._id}}">
                    <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24" />
                    </div>
                    <h4 class="item-name">{{item.name}}</h4>
                    <div class="item-controls">
                        <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                        <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                    </div>
                </li>
                {{/each}}
            </ol>
        </div>
        {{!-- Charms Tab --}}
        <div class="tab items" data-group="primary" data-tab="charms">
            <ol class="items-list">
                <li class="item flexrow item-header">
                    <div class="item-image"></div>
                    <div class="item-name"></div>
                    <div class="items-controls d-flex">
                        <a class="item-control margin-right item-create" title="Create charm" data-type="charm"><i
                                class="fas fa-plus"></i> Add charm</a>
                        <a class="item-control item-create" title="Create spell" data-type="spell"><i
                                class="fas fa-plus"></i> Add
                            spell</a>
                    </div>
                </li>
                {{#each actor.charms as |charm ability|}}
                {{#if charm.visible}}
                <li class="item flexrow item-header flex-center">
                    <div class="item-name">{{localize charm.name}}</div>
                </li>
                {{#each charm.list as |item id|}}
                <li class="item flexrow" data-item-id="{{item._id}}">
                    <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24" />
                    </div>
                    <h4 class="item-name">{{item.name}}</h4>
                    <div class="item-controls">
                        <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                        <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                    </div>
                </li>
                {{/each}}
                {{/if}}
                {{/each}}
                <li>
                    <div class="resource-label list-section-header">
                        {{localize "ExEss.Spells"}}
                    </div>
                </li>
                <li>
                    {{#each actor.spells as |spell circle|}}
                    {{#if spell.visible}}
                <li class="item flexrow item-header flex-center">
                    <div class="item-name">{{localize spell.name}}</div>
                </li>
                {{#each spell.list as |item id|}}
                <li class="item flexrow" data-item-id="{{item._id}}">
                    <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24" />
                    </div>
                    <h4 class="item-name">{{item.name}} ({{item.data.spelltype}})</h4>
                    <div class="item-controls">
                        <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                        <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                    </div>
                </li>
                {{/each}}
                {{/if}}
                {{/each}}
                </li>
            </ol>
        </div>

        {{!-- Intimacy Tab --}}
        <div class="tab intimacies" data-group="primary" data-tab="intimacies">
            <ol class="items-list">
                <li>
                    <div class="grid grid-2col flex-group-center">
                        <div class="resource-content flexrow flex-center flex-between">
                            <div>
                                <label class="resource-label">{{localize "ExEss.MajorVirtue"}}</label>
                                <input name="data.details.majorvirtue" value="{{data.data.details.majorvirtue}}"
                                    type="text" />
                            </div>
                        </div>
                        <div class="resource-content flexrow flex-center flex-between">
                            <div>
                                <label class="resource-label">{{localize "ExEss.MinorVirtue"}}</label>
                                <input name="data.details.minorvirtue" value="{{data.data.details.minorvirtue}}"
                                    type="text" />
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="resource-label flex-center list-section-header">
                        {{localize "ExEss.Intimacies"}}
                    </div>
                </li>
                <li class="item flexrow item-header">
                    <div class="item-image"></div>
                    <div class="item-name">Name</div>
                    <div class="item-name">Strength</div>
                    <div class="item-name">Virtue</div>
                    <div class="item-controls">
                        <a class="item-control item-create" title="Create intimacy" data-type="intimacy"><i
                                class="fas fa-plus"></i>
                            Add</a>
                    </div>
                </li>
                {{#each actor.intimacies as |item id|}}
                <li class="item flexrow" data-item-id="{{item._id}}">
                    <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24" />
                    </div>
                    <h4 class="item-name">{{item.name}} ({{item.data.intimacytype}})</h4>
                    <div class="resource-table-value resource-value-static">
                        {{item.data.strength}}
                    </div>
                    <div class="resource-table-value resource-value-static">
                        {{item.data.virtue}}
                    </div>
                    <div class="item-controls">
                        <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                        <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                    </div>
                </li>
                {{/each}}
            </ol>
        </div>

        {{!-- Biography Tab --}}
        <div class="tab biography" data-group="primary" data-tab="description">
            {{editor content=data.data.biography target="data.biography" button=true owner=owner editable=true}}
        </div>
    </section>
</form>